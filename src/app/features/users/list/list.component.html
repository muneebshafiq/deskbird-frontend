<div class="max-w-7xl mx-auto p-6">
  <div class="flex justify-between items-start mb-6">
    <div>
      <h1 class="text-3xl font-bold text-primary">Users Management</h1>
      <p class="mt-2 text-color-secondary" *ngIf="(isAdmin$ | async) === false">
        You are viewing the users list in read-only mode.
      </p>
    </div>
    <p-button 
      *ngIf="isAdmin$ | async" 
      icon="pi pi-plus" 
      label="Add User" 
      severity="success"
      (click)="addUser()"
    ></p-button>
  </div>

  <div class="bg-surface rounded-lg shadow-sm">
    <p-table 
      [value]="users" 
      [paginator]="true" 
      [rows]="10" 
      [loading]="loading"
      responsiveLayout="scroll"
      class="w-full"
    >
      <ng-template pTemplate="header">
        <tr>
          <th class="text-left p-4 font-semibold text-primary">Name</th>
          <th class="text-left p-4 font-semibold text-primary">Email</th>
          <th class="text-left p-4 font-semibold text-primary">Role</th>
          <th class="text-left p-4 font-semibold text-primary">Created At</th>
          <th *ngIf="isAdmin$ | async" class="text-center p-4 font-semibold text-primary w-32">Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-user>
        <tr class="border-t border-surface-border hover:bg-surface-hover">
          <td class="p-4">
            <div class="font-medium text-primary">{{ user.name }}</div>
          </td>
          <td class="p-4">
            <div class="text-color-secondary">{{ user.email }}</div>
          </td>
          <td class="p-4">
            <p-tag 
              [value]="user.role" 
              [severity]="user.role === 'admin' ? 'danger' : 'info'"
            ></p-tag>
          </td>
          <td class="p-4">
            <div class="text-color-secondary">{{ user.createdAt | date:'medium' }}</div>
          </td>
          <td *ngIf="isAdmin$ | async" class="p-4">
            <div class="flex justify-center gap-2">
              <p-button 
                icon="pi pi-pencil" 
                severity="secondary"
                size="small"
                [text]="true"
                (click)="editUser(user)"
                pTooltip="Edit user"
                tooltipPosition="top"
              ></p-button>
              <p-button 
                icon="pi pi-trash" 
                severity="danger"
                size="small"
                [text]="true"
                (click)="deleteUser(user.id)"
                pTooltip="Delete user"
                tooltipPosition="top"
              ></p-button>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="emptymessage">
        <tr>
          <td [attr.colspan]="(isAdmin$ | async) ? 5 : 4" class="text-center py-12">
            <div class="flex flex-col items-center gap-3">
              <i class="pi pi-users text-4xl text-color-secondary"></i>
              <p class="text-color-secondary text-lg">No users found</p>
            </div>
          </td>
        </tr>
      </ng-template>
    </p-table>
  </div>
</div>
